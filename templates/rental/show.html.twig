{% extends 'base.html.twig' %}

{% block title %}Detalle de alquiler{% endblock %}

{% block body %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="fw-bold mb-0">
        <i class="bi bi-film"></i> Alquiler #{{ rental.id }}
    </h2>
    <div class="d-flex gap-2">
        {% if not rental.returnDate %}
            <a href="{{ path('rental_return', {id: rental.id}) }}" class="btn btn-warning">
                <i class="bi bi-arrow-return-left"></i> Registrar devolución
            </a>
        {% endif %}
        <a href="{{ path('rental_index') }}" class="btn btn-secondary">
            <i class="bi bi-arrow-left"></i> Volver
        </a>
    </div>
</div>

<ul class="list-group mb-3">
    <li class="list-group-item">
        <strong>Cliente:</strong> {{ rental.customer.fullName }} (ID {{ rental.customer.id }})
    </li>
    <li class="list-group-item">
        <strong>Película:</strong> {{ rental.inventory.film.title }} <br>
        <small class="text-muted">
            Inventario #{{ rental.inventory.store.storeId }} - Tienda {{ rental.inventory.store.storeId }}
        </small>
    </li>
    <li class="list-group-item">
        <strong>Empleado:</strong> {{ rental.staff.username }}
    </li>
    <li class="list-group-item">
        <strong>Fecha de alquiler:</strong> {{ rental.rentalDate|date('Y-m-d H:i') }}
    </li>
    <li class="list-group-item">
        <strong>Fecha de devolución:</strong>
        {% if rental.returnDate %}
            {{ rental.returnDate|date('Y-m-d H:i') }}
        {% else %}
            <span class="badge bg-success">Alquiler activo</span>
        {% endif %}
    </li>
    <li class="list-group-item">
        {% if lateDays is not null %}
            {% if lateDays > 0 %}
                <span class="text-danger">
                    Retraso de <strong>{{ lateDays }}</strong> día(s)
                    (plazo: {{ allowedDays }} día(s)).
                </span>
            {% else %}
                <span class="text-success">
                    Sin retraso. Plazo: {{ allowedDays }} día(s).
                </span>
            {% endif %}
        {% else %}
            <span class="text-muted">
                El cálculo de retraso se mostrará cuando se registre la devolución.
            </span>
        {% endif %}
    </li>
</ul>
{% endblock %}
